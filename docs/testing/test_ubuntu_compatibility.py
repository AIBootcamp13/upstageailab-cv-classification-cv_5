#!/usr/bin/env python3\n\"\"\"\nUbuntu í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸\nUbuntu í™˜ê²½ì—ì„œ í”„ë¡œì íŠ¸ê°€ ì •ìƒ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.\n\"\"\"\n\nimport sys\nimport os\nimport platform\nimport subprocess\nfrom pathlib import Path\n\ndef check_system_info():\n    \"\"\"ì‹œìŠ¤í…œ ì •ë³´ í™•ì¸\"\"\"\n    print(\"ğŸ–¥ï¸  ì‹œìŠ¤í…œ ì •ë³´ í™•ì¸\")\n    print(\"=\" * 50)\n    \n    system_info = {\n        'OS': platform.system(),\n        'OS Release': platform.release(),\n        'Architecture': platform.machine(),\n        'Python Version': platform.python_version(),\n        'Platform': platform.platform()\n    }\n    \n    for key, value in system_info.items():\n        print(f\"  {key}: {value}\")\n    \n    # Ubuntu ê°ì§€\n    is_ubuntu = False\n    if platform.system() == 'Linux':\n        try:\n            with open('/etc/os-release', 'r') as f:\n                content = f.read()\n                if 'ubuntu' in content.lower():\n                    is_ubuntu = True\n                    print(\"  âœ… Ubuntu ê°ì§€ë¨\")\n        except:\n            pass\n    \n    if not is_ubuntu and platform.system() == 'Linux':\n        print(\"  âš ï¸  Linux ì‹œìŠ¤í…œì´ì§€ë§Œ Ubuntuê°€ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤\")\n    \n    return is_ubuntu\n\ndef check_python_environment():\n    \"\"\"Python í™˜ê²½ í™•ì¸\"\"\"\n    print(\"\\nğŸ Python í™˜ê²½ í™•ì¸\")\n    print(\"=\" * 50)\n    \n    # Python ë²„ì „ í™•ì¸\n    python_version = sys.version_info\n    print(f\"  Python ë²„ì „: {python_version.major}.{python_version.minor}.{python_version.micro}\")\n    \n    if python_version.major < 3 or (python_version.major == 3 and python_version.minor < 8):\n        print(\"  âŒ Python 3.8 ì´ìƒì´ í•„ìš”í•©ë‹ˆë‹¤\")\n        return False\n    else:\n        print(\"  âœ… Python ë²„ì „ í˜¸í™˜\")\n    \n    # í•„ìˆ˜ íŒ¨í‚¤ì§€ í™•ì¸\n    required_packages = [\n        'torch', 'torchvision', 'numpy', 'pandas', 'pillow',\n        'albumentations', 'timm', 'scikit-learn', 'tqdm',\n        'wandb', 'matplotlib', 'seaborn'\n    ]\n    \n    missing_packages = []\n    for package in required_packages:\n        try:\n            __import__(package)\n            print(f\"  âœ… {package}\")\n        except ImportError:\n            print(f\"  âŒ {package} (ëˆ„ë½)\")\n            missing_packages.append(package)\n    \n    if missing_packages:\n        print(f\"\\n  ğŸ“¦ ëˆ„ë½ëœ íŒ¨í‚¤ì§€: {', '.join(missing_packages)}\")\n        print(\"     ì„¤ì¹˜ ëª…ë ¹ì–´: pip install \" + ' '.join(missing_packages))\n        return False\n    \n    return True\n\ndef check_gpu_support():\n    \"\"\"GPU ì§€ì› í™•ì¸\"\"\"\n    print(\"\\nğŸš€ GPU ì§€ì› í™•ì¸\")\n    print(\"=\" * 50)\n    \n    try:\n        import torch\n        \n        # CUDA í™•ì¸\n        if torch.cuda.is_available():\n            gpu_count = torch.cuda.device_count()\n            gpu_name = torch.cuda.get_device_name(0)\n            print(f\"  âœ… CUDA ì‚¬ìš© ê°€ëŠ¥\")\n            print(f\"     GPU ê°œìˆ˜: {gpu_count}\")\n            print(f\"     GPU ì´ë¦„: {gpu_name}\")\n            print(f\"     CUDA ë²„ì „: {torch.version.cuda}\")\n            \n            # GPU ë©”ëª¨ë¦¬ í™•ì¸\n            total_memory = torch.cuda.get_device_properties(0).total_memory / 1e9\n            print(f\"     GPU ë©”ëª¨ë¦¬: {total_memory:.1f} GB\")\n            \n            return 'cuda'\n        else:\n            print(\"  âš ï¸  CUDA ì‚¬ìš© ë¶ˆê°€ - CPU ëª¨ë“œë¡œ ì‹¤í–‰\")\n            return 'cpu'\n            \n    except ImportError:\n        print(\"  âŒ PyTorchê°€ ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ\")\n        return None\n\ndef check_project_structure():\n    \"\"\"í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸\"\"\"\n    print(\"\\nğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸\")\n    print(\"=\" * 50)\n    \n    project_root = Path.cwd()\n    \n    required_files = [\n        'codes/config.py',\n        'codes/device_utils.py',\n        'codes/wandb_utils.py',\n        'codes/train_with_wandb.py',\n        'menu.sh'\n    ]\n    \n    required_dirs = [\n        'data',\n        'models',\n        'logs',\n        'codes'\n    ]\n    \n    # í•„ìˆ˜ ë””ë ‰í† ë¦¬ í™•ì¸\n    for dir_name in required_dirs:\n        dir_path = project_root / dir_name\n        if dir_path.exists():\n            print(f\"  âœ… {dir_name}/\")\n        else:\n            print(f\"  âŒ {dir_name}/ (ëˆ„ë½)\")\n    \n    # í•„ìˆ˜ íŒŒì¼ í™•ì¸\n    for file_path in required_files:\n        full_path = project_root / file_path\n        if full_path.exists():\n            print(f\"  âœ… {file_path}\")\n        else:\n            print(f\"  âŒ {file_path} (ëˆ„ë½)\")\n    \n    # ë°ì´í„° íŒŒì¼ í™•ì¸\n    data_files = ['data/train.csv', 'data/sample_submission.csv']\n    for data_file in data_files:\n        data_path = project_root / data_file\n        if data_path.exists():\n            print(f\"  âœ… {data_file}\")\n        else:\n            print(f\"  âš ï¸  {data_file} (ì„ íƒì‚¬í•­)\")\n\ndef test_device_detection():\n    \"\"\"ë””ë°”ì´ìŠ¤ ê°ì§€ í…ŒìŠ¤íŠ¸\"\"\"\n    print(\"\\nğŸ”§ ë””ë°”ì´ìŠ¤ ê°ì§€ í…ŒìŠ¤íŠ¸\")\n    print(\"=\" * 50)\n    \n    try:\n        # í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ì¶”ê°€\n        sys.path.append(str(Path.cwd() / 'codes'))\n        \n        from device_utils import setup_training_device, get_dataloader_config\n        \n        print(\"  ë””ë°”ì´ìŠ¤ ê°ì§€ ì¤‘...\")\n        device, device_type = setup_training_device()\n        \n        print(f\"  âœ… ê°ì§€ëœ ë””ë°”ì´ìŠ¤: {device} ({device_type})\")\n        \n        # DataLoader ì„¤ì • í™•ì¸\n        dataloader_config = get_dataloader_config(device_type)\n        print(f\"  ğŸ“Š DataLoader ì„¤ì •:\")\n        for key, value in dataloader_config.items():\n            print(f\"     {key}: {value}\")\n        \n        return True\n        \n    except Exception as e:\n        print(f\"  âŒ ë””ë°”ì´ìŠ¤ ê°ì§€ ì‹¤íŒ¨: {e}\")\n        return False\n\ndef test_simple_training():\n    \"\"\"ê°„ë‹¨í•œ í›ˆë ¨ í…ŒìŠ¤íŠ¸\"\"\"\n    print(\"\\nğŸ§ª ê°„ë‹¨í•œ í›ˆë ¨ í…ŒìŠ¤íŠ¸\")\n    print(\"=\" * 50)\n    \n    try:\n        import torch\n        import torch.nn as nn\n        import numpy as np\n        \n        # ê°„ë‹¨í•œ ëª¨ë¸ ìƒì„±\n        model = nn.Linear(10, 1)\n        device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n        model = model.to(device)\n        \n        # ë”ë¯¸ ë°ì´í„° ìƒì„±\n        x = torch.randn(32, 10).to(device)\n        y = torch.randn(32, 1).to(device)\n        \n        # ìˆœì „íŒŒ í…ŒìŠ¤íŠ¸\n        output = model(x)\n        loss = nn.MSELoss()(output, y)\n        \n        # ì—­ì „íŒŒ í…ŒìŠ¤íŠ¸\n        loss.backward()\n        \n        print(f\"  âœ… ìˆœì „íŒŒ/ì—­ì „íŒŒ í…ŒìŠ¤íŠ¸ ì„±ê³µ\")\n        print(f\"     ë””ë°”ì´ìŠ¤: {device}\")\n        print(f\"     ì†ì‹¤ê°’: {loss.item():.4f}\")\n        \n        return True\n        \n    except Exception as e:\n        print(f\"  âŒ í›ˆë ¨ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨: {e}\")\n        return False\n\ndef check_permissions():\n    \"\"\"íŒŒì¼ ê¶Œí•œ í™•ì¸\"\"\"\n    print(\"\\nğŸ” íŒŒì¼ ê¶Œí•œ í™•ì¸\")\n    print(\"=\" * 50)\n    \n    project_root = Path.cwd()\n    \n    # ì“°ê¸° ê¶Œí•œì´ í•„ìš”í•œ ë””ë ‰í† ë¦¬\n    write_dirs = ['models', 'logs', 'data']\n    \n    for dir_name in write_dirs:\n        dir_path = project_root / dir_name\n        if dir_path.exists():\n            if os.access(dir_path, os.W_OK):\n                print(f\"  âœ… {dir_name}/ (ì“°ê¸° ê°€ëŠ¥)\")\n            else:\n                print(f\"  âŒ {dir_name}/ (ì“°ê¸° ë¶ˆê°€)\")\n        else:\n            try:\n                dir_path.mkdir(parents=True, exist_ok=True)\n                print(f\"  âœ… {dir_name}/ (ìƒì„±ë¨)\")\n            except PermissionError:\n                print(f\"  âŒ {dir_name}/ (ìƒì„± ë¶ˆê°€)\")\n    \n    # ì‹¤í–‰ ê¶Œí•œ í™•ì¸\n    menu_script = project_root / 'menu.sh'\n    if menu_script.exists():\n        if os.access(menu_script, os.X_OK):\n            print(f\"  âœ… menu.sh (ì‹¤í–‰ ê°€ëŠ¥)\")\n        else:\n            print(f\"  âš ï¸  menu.sh (ì‹¤í–‰ ê¶Œí•œ ì—†ìŒ)\")\n            print(f\"     í•´ê²° ë°©ë²•: chmod +x menu.sh\")\n\ndef run_all_tests():\n    \"\"\"ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰\"\"\"\n    print(\"ğŸ” Ubuntu í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸ ì‹œì‘\")\n    print(\"=\" * 60)\n    \n    tests = [\n        (\"ì‹œìŠ¤í…œ ì •ë³´\", check_system_info),\n        (\"Python í™˜ê²½\", check_python_environment), \n        (\"GPU ì§€ì›\", check_gpu_support),\n        (\"í”„ë¡œì íŠ¸ êµ¬ì¡°\", check_project_structure),\n        (\"ë””ë°”ì´ìŠ¤ ê°ì§€\", test_device_detection),\n        (\"ê°„ë‹¨í•œ í›ˆë ¨\", test_simple_training),\n        (\"íŒŒì¼ ê¶Œí•œ\", check_permissions)\n    ]\n    \n    results = []\n    \n    for test_name, test_func in tests:\n        try:\n            result = test_func()\n            results.append((test_name, result))\n        except Exception as e:\n            print(f\"\\nâŒ {test_name} í…ŒìŠ¤íŠ¸ ì¤‘ ì˜¤ë¥˜: {e}\")\n            results.append((test_name, False))\n    \n    # ê²°ê³¼ ìš”ì•½\n    print(\"\\n\" + \"=\" * 60)\n    print(\"ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½\")\n    print(\"=\" * 60)\n    \n    passed = 0\n    total = len([r for r in results if r[1] is not None])\n    \n    for test_name, result in results:\n        if result is True:\n            print(f\"  âœ… {test_name}\")\n            passed += 1\n        elif result is False:\n            print(f\"  âŒ {test_name}\")\n        else:\n            print(f\"  â„¹ï¸  {test_name} (ì •ë³´ë§Œ í‘œì‹œ)\")\n    \n    print(f\"\\nğŸ“ˆ í†µê³¼ìœ¨: {passed}/{total} ({passed/total*100:.1f}%)\")\n    \n    if passed == total:\n        print(\"\\nğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼! Ubuntuì—ì„œ ì •ìƒ ì‹¤í–‰ ê°€ëŠ¥í•©ë‹ˆë‹¤.\")\n    elif passed >= total * 0.8:\n        print(\"\\nâš ï¸  ëŒ€ë¶€ë¶„ì˜ í…ŒìŠ¤íŠ¸ í†µê³¼. ì¼ë¶€ ê¸°ëŠ¥ì— ì œí•œì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\")\n    else:\n        print(\"\\nâŒ ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨. í™˜ê²½ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.\")\n        print(\"\\nğŸ’¡ í•´ê²° ë°©ë²•:\")\n        print(\"   1. í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜: pip install -r requirements.txt\")\n        print(\"   2. CUDA ì„¤ì¹˜ (GPU ì‚¬ìš© ì‹œ): NVIDIA ë“œë¼ì´ë²„ ë° CUDA íˆ´í‚·\")\n        print(\"   3. íŒŒì¼ ê¶Œí•œ ì„¤ì •: chmod +x menu.sh\")\n        print(\"   4. í”„ë¡œì íŠ¸ êµ¬ì¡° í™•ì¸: í•„ìˆ˜ íŒŒì¼/ë””ë ‰í† ë¦¬ ëˆ„ë½ ì—¬ë¶€\")\n\nif __name__ == \"__main__\":\n    run_all_tests()\n